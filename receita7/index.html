<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <link href="style.css" rel="stylesheet">
  <title>Fetch</title>
</head>
<body>

  <div><button id="botaoCarregar">Carregar pessoas</button></div>
  <div id="pessoasDiv"></div>

  <script>
    async function carregarPessoas() {
      const botao = document.getElementById("botaoCarregar");
      botao.textContent = "Carregando...";

      try {
        const res = await fetch("https://random-data-api.com/api/v2/users?size=3");
        const dados = await res.json();
        console.log(dados);

        // Arrumar o estilo da tabela

        // Retirar o street e adicionar outro no lugar(ou outros)
        const cabecalhos = ["First Name", "Last Name", "Email", "Street", "City"];

        // retirar esse trecho de codigo e fazer o programa funcionar sem ele, usando só a função de tabela.js
        const dadosFormatados = dados.map(p => ({
          first_name: p.first_name,
          last_name: p.last_name,
          email: p.email,
          street: p.address?.street || "N/A",
          city: p.address?.city || "N/A"
        }));


        // possivelmente vai ter que ajustar a função aqui(formato e/ou parametros passados)
        // dá pra deixar ela assim -> carregarTabela(usuarios, cabecalhos);
        carregarTabela(dadosFormatados, cabecalhos, "pessoasDiv");

      } catch (err) {
        document.getElementById("pessoasDiv").innerHTML = "Erro ao carregar pessoas.";
        console.error("Erro:", err);
      } finally {
        botao.textContent = "Carregar pessoas";
      }
    }

    function carregarTabela(dados, cabecalhos, idElemento = "pessoasDiv") {
      const div = document.getElementById(idElemento);
      if (!dados || dados.length === 0) {
        div.innerHTML = "<p>Nenhum dado encontrado.</p>";
        return;
      }

      const cabecalhoHtml = cabecalhos.map(c => `<th>${c}</th>`).join("");
      const corpoHtml = dados.map(item => {
        const colunas = cabecalhos.map(c => {
          const chave = c.toLowerCase().replace(/ /g, "_");
          return `<td>${item[chave] || "Não disponível"}</td>`;
        }).join("");
        return `<tr>${colunas}</tr>`;
      }).join("");

      const tabelaHtml = `
        <table border="1">
          <thead><tr>${cabecalhoHtml}</tr></thead>
          <tbody>${corpoHtml}</tbody>
        </table>
      `;
      div.innerHTML = tabelaHtml;
    }

    document.getElementById("botaoCarregar").addEventListener("click", carregarPessoas);
  </script>
</body>
</html>
